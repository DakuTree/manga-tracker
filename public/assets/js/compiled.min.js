$(function(){$('[data-toggle="tooltip"]').tooltip({html:!0})});$(function(){function c(a,e){e="undefined"!==typeof e?e:!1;$("#import-status").text(a).show().delay(4E3).fadeOut(1E3).attr("style",e?"color: rgb(0, 230 ,0)":"color: rgb(230, 0 ,0)")}if("dashboard"!==page)return!1;$(".tablesorter").tablesorter();$(".tracker-table").find("> tbody > tr > td:nth-of-type(1)").click(function(a){$(a.target).is("input")||(a=$(this).find("> input[type=checkbox]"),$(a).prop("checked",!a.prop("checked")))});$(".update-read").click(function(){var a=this,e=$(this).closest("tr"),
b=$(e).attr("data-id"),d=$(e).find(".current"),c=$(e).find(".latest");$.post(base_url+"ajax/update_inline",{id:b,chapter:c.attr("data-chapter")},function(){$(a).hide();$(d).attr("href",$(c).attr("href")).text($(c).text())}).fail(function(a,b,e){switch(a.status){case 400:alert("ERROR: "+e);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+e)}})});$("#delete_selected").click(function(a){a.preventDefault();a=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");
0<a.length&&(a=$(a).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/delete_inline",{"id[]":a},function(){location.reload()}).fail(function(a,b,d){switch(a.status){case 400:alert("ERROR: "+d);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+d)}}))});$("#file_import").change(function(){var a=this.files;if(a&&a[0])if(a=a[0],a.name.match(/\.json$/))if(2097152<a.size)c("ERROR: File too large ( < 2MB)!");else{var b=
new FileReader;b.onload=function(a){a=a.target.result;var b;a:{try{JSON.parse(a)}catch(e){b=!1;break a}b=!0}b?(b=new FormData,b.append("json",a),$.ajax({type:"POST",url:"./import_list",data:b,success:function(){c("Upload was a success! Reloading page.",!0);setTimeout(function(){location.reload()},2500)},error:function(a,b,e){switch(a.status){case 400:alert("ERROR: "+e);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+e)}},contentType:!1,processData:!1})):
c("ERROR: File isn't valid JSON!")};b.readAsText(a)}else c("ERROR: Only .json is supported!")});$(".more-info").click(function(a){a.preventDefault();$(this).find("+ .tags").toggle();"More info"==$(this).text()?$(this).text("Hide info"):$(this).text("More info")});$(".edit-tags").click(function(a){a.preventDefault();$(this).parent().find(".tag-edit").toggleClass("hidden")});$(".tag-edit input").on("keypress",function(){13===event.which&&$(this).closest(".tag-edit").find("[type=button]").click()});
$(".tag-edit [type=button]").click(function(){var a=this,b=$(this).closest(".tag-edit").find("input").val().trim().replace(/,,/g,","),d=$(this).closest("tr").attr("data-id");if(/^[a-z0-9,\-_]{0,255}$/.test(b)){var c=b.split(",");-1===$.inArray("none",c)?$.post(base_url+"ajax/tag_update",{id:d,tag_string:c.join(",")},function(){$(a).closest(".tags").find(".tag-list").text(c.join(",")||"none");$(a).closest(".tag-edit").toggleClass("hidden")}).fail(function(a,b,e){switch(a.status){case 400:alert("ERROR: "+
e);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+e)}}):alert('"none" is a restricted tag.')}else alert("Tags can only contain: lowercase a-z, 0-9, - & _.")});$("#category-nav > .nav > li > a").click(function(a){a.preventDefault();$(this).closest("ul").find("> .active").removeClass("active");$(this).parent().addClass("active");$(".tracker-table:visible").hide();$('.tracker-table[data-list="'+$(this).attr("data-list")+'"]').show()});$("#move-input").change(function(){var a=
$(this).find(":selected");if(a.is("[value]")){var b=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");0<b.length&&(b=$(b).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/set_category",{"id[]":b,category:a.attr("value")},function(){location.reload()}).fail(function(a,b,e){switch(a.status){case 400:alert("ERROR: "+e);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+e)}}))}});if("undefined"!==
typeof use_live_countdown_timer&&use_live_countdown_timer)var g=$("#update-timer"),b=g.text().split(":"),d=parseInt(3600*b[0],10)+parseInt(60*b[1],10)+parseInt(b[2],10),h=setInterval(function(){var a=parseInt(d/60/60,10).toString(),b=parseInt(d/60%60,10).toString(),c=parseInt(d%60,10).toString();1==a.length&&(a="0"+a);1==b.length&&(b="0"+b);1==c.length&&(c="0"+c);g.text(a+":"+b+":"+c);0>--d&&clearInterval(h)},1E3);var f=$(window),k=$("#list-nav"),l=$("table[data-list]");f.scroll(function(){console.log(f.scrollTop());
99<=f.scrollTop()?(k.addClass("fixed-header"),k.css("width",$("#list-nav").parent().width()+"px"),l.css("margin-top","97px")):(k.removeClass("fixed-header"),k.css("width","initial"),l.css("margin-top","5px"))})});$(function(){if("login"!==page)return!1;$(".button-checkbox").each(function(){function c(){var c=d.is(":checked");b.data("state",c?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+f[b.data("state")].icon);c?b.removeClass("btn-default").addClass("btn-"+h+" active"):b.removeClass("btn-"+h+" active").addClass("btn-default")}var g=$(this),b=g.find("button"),d=g.find("input:checkbox"),h=b.data("color"),f={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};
b.on("click",function(){d.prop("checked",!d.is(":checked"));d.triggerHandler("change");c()});d.on("change",function(){c()});c();0==b.find(".state-icon").length&&b.prepend('<i class="state-icon '+f[b.data("state")].icon+'"></i>\u00a0')})});$(function(){if("options"!==page)return!1;$("input[type=checkbox][name^=category_custom]").change(function(c){"1"==$(this).data("has-series")&&(alert("Unable to disable category while it still contains series."),$(this).prop("checked",!$(this).prop("checked")))});$("input[type=text][name^=category_custom]").click(function(){$(this).parent().find("[type=checkbox]").attr("checked",!0)})});$(function(){if("signup"!==page)return!1;$("#page[data-page=signup]").find("form").validate({ignore:[],onkeyup:!1,rules:{username:{minlength:4,maxlength:15,pattern:/^[a-zA-Z0-9_-]{4,15}$/,remote:{url:base_url+"ajax/username_check",type:"post",data:{username:function(){return $("input[name='username']").val()}}}}},messages:{username:{minlength:"This username is too short (Minimum 4 characters).",maxlength:"This username is too long (Maximum 15 characters).",pattern:"This username has invalid characters (Only allowed a-z, A-Z, 0-9, _ & - characters).",
remote:"This username already taken."}}});$(".button-checkbox").each(function(){function c(){var c=d.is(":checked");b.data("state",c?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+f[b.data("state")].icon);c?b.removeClass("btn-default").addClass("btn-"+h+" active"):b.removeClass("btn-"+h+" active").addClass("btn-default")}var g=$(this),b=g.find("button"),d=g.find("input:checkbox"),h=b.data("color"),f={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};
b.on("click",function(){d.prop("checked",!d.is(":checked"));d.triggerHandler("change");c()});d.on("change",function(){c()});c();0==b.find(".state-icon").length&&b.prepend('<i class="state-icon '+f[b.data("state")].icon+'"></i>')})});
