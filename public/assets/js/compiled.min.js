$(function(){$('[data-toggle="tooltip"]').tooltip({html:!0})});$(function(){function d(a,b){b="undefined"!==typeof b?b:!1;$("#import-status").text(a).show().delay(4E3).fadeOut(1E3).attr("style",b?"color: rgb(0, 230 ,0)":"color: rgb(230, 0 ,0)")}$(".tablesorter").tablesorter();$(".tracker-table").find("> tbody > tr > td:nth-of-type(1)").click(function(a){$(a.target).is("input")||(a=$(this).find("> input[type=checkbox]"),$(a).prop("checked",!a.prop("checked")))});$(".update-read").click(function(){var a=this,b=$(this).closest("tr"),k=$(b).attr("data-id"),g=$(b).find(".current"),
c=$(b).find(".latest");$.post(base_url+"ajax/update_inline",{id:k,chapter:c.attr("data-chapter")},function(){$(a).hide();$(g).attr("href",$(c).attr("href")).text($(c).text())}).fail(function(a,b,c){switch(a.status){case 400:alert("ERROR: "+c);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+c)}})});$("#delete_selected").click(function(a){a.preventDefault();a=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");0<a.length&&
(a=$(a).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/delete_inline",{"id[]":a},function(){location.reload()}).fail(function(a,c,g){switch(a.status){case 400:alert("ERROR: "+g);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+g)}}))});$("#file_import").change(function(){var a=this.files;if(a&&a[0])if(a=a[0],a.name.match(/\.json$/))if(2097152<a.size)d("ERROR: File too large ( < 2MB)!");else{var b=new FileReader;
b.onload=function(a){a=a.target.result;var b;a:{try{JSON.parse(a)}catch(c){b=!1;break a}b=!0}b?(b=new FormData,b.append("json",a),$.ajax({type:"POST",url:"./import_list",data:b,success:function(){d("Upload was a success! Reloading page.",!0);setTimeout(function(){location.reload()},2500)},error:function(a,b,c){d("ERROR: Upload failed! - "+a.status)},contentType:!1,processData:!1})):d("ERROR: File isn't valid JSON!")};b.readAsText(a)}else d("ERROR: Only .json is supported!")});$(".more-info").click(function(a){a.preventDefault();
$(this).find("+ .tags").toggle();"More info"==$(this).text()?$(this).text("Hide info"):$(this).text("More info")});$(".edit-tags").click(function(a){a.preventDefault();$(this).parent().find(".tag-edit").toggleClass("hidden")});$(".tag-edit input").on("keypress",function(){13===event.which&&$(this).closest(".tag-edit").find("[type=button]").click()});$(".tag-edit [type=button]").click(function(){var a=this,b=$(this).closest(".tag-edit").find("input").val().trim().replace(/,,/g,","),c=$(this).closest("tr").attr("data-id");
if(/^[a-z0-9,\-_]{0,255}$/.test(b)){var d=b.split(",");-1===$.inArray("none",d)?(b=new FormData,b.append("id",c),b.append("tag_string",d.join(",")),$.ajax({type:"POST",url:"./ajax/tag/update",data:b,success:function(){$(a).closest(".tags").find(".tag-list").text(d.join(",")||"none");$(a).closest(".tag-edit").toggleClass("hidden")},error:function(a,b,c){},contentType:!1,processData:!1})):alert('"none" is a restricted tag.')}else alert("Tags can only contain: lowercase a-z, 0-9, - & _.")});$("#category-nav > .nav > li > a").click(function(a){a.preventDefault();
$(this).closest("ul").find("> .active").removeClass("active");$(this).parent().addClass("active");$(".tracker-table:visible").hide();$('.tracker-table[data-list="'+$(this).attr("data-list")+'"]').show()});$("#move-input").change(function(){var a=$(this).find(":selected");if(a.is("[value]")){var b=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");if(0<b.length){var c={id_list:[],category:a.attr("value")};$(b).each(function(){c.id_list.push($(this).attr("data-id"))});a=new FormData;
a.append("json",JSON.stringify(c));$.ajax({type:"POST",url:"./ajax/set_category",data:a,success:function(){location.reload()},error:function(a,b,c){},contentType:!1,processData:!1})}}});if("undefined"!==typeof use_live_countdown_timer&&use_live_countdown_timer)var f=$("#update-timer"),c=f.text().split(":"),e=parseInt(3600*c[0],10)+parseInt(60*c[1],10)+parseInt(c[2],10),h=setInterval(function(){var a=parseInt(e/60/60,10).toString(),b=parseInt(e/60%60,10).toString(),c=parseInt(e%60,10).toString();1==
a.length&&(a="0"+a);1==b.length&&(b="0"+b);1==c.length&&(c="0"+c);f.text(a+":"+b+":"+c);0>--e&&clearInterval(h)},1E3)});$(function(){$(".button-checkbox").each(function(){function d(){var b=e.is(":checked");c.data("state",b?"on":"off");c.find(".state-icon").removeClass().addClass("state-icon "+a[c.data("state")].icon);b?c.removeClass("btn-default").addClass("btn-"+h+" active"):c.removeClass("btn-"+h+" active").addClass("btn-default")}var f=$(this),c=f.find("button"),e=f.find("input:checkbox"),h=c.data("color"),a={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};c.on("click",function(){e.prop("checked",
!e.is(":checked"));e.triggerHandler("change");d()});e.on("change",function(){d()});d();0==c.find(".state-icon").length&&c.prepend('<i class="state-icon '+a[c.data("state")].icon+'"></i>\u00a0')})});$(function(){$("input[type=checkbox][name^=category_custom]").change(function(d){"1"==$(this).data("has-series")&&(alert("Unable to disable category while it still contains series."),$(this).prop("checked",!$(this).prop("checked")))});$("input[type=text][name^=category_custom]").click(function(){$(this).parent().find("[type=checkbox]").attr("checked",!0)})});$(function(){$("#page[data-page=signup] form").validate({ignore:[],onkeyup:!1,rules:{username:{minlength:4,maxlength:15,pattern:/^[a-zA-Z0-9_-]{4,15}$/,remote:{url:base_url+"ajax/username_check",type:"post",data:{username:function(){return $("input[name='username']").val()}}}}},messages:{username:{minlength:"This username is too short (Minimum 4 characters).",maxlength:"This username is too long (Maximum 15 characters).",pattern:"This username has invalid characters (Only allowed a-z, A-Z, 0-9, _ & - characters).",
remote:"This username already taken."}}})});
