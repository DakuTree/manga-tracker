$(function(){$('[data-toggle="tooltip"]').tooltip({html:!0})});$(function(){function c(a,e){e="undefined"!==typeof e?e:!1;$("#import-status").text(a).show().delay(4E3).fadeOut(1E3).attr("style",e?"color: rgb(0, 230 ,0)":"color: rgb(230, 0 ,0)")}function f(){l.scrollTop()>=n?(m.css("margin-top","97px"),k.addClass("fixed-header"),k.css("width",$("#list-nav").parent().width()+"px")):(m.css("margin-top","5px"),k.removeClass("fixed-header"),k.css("width","initial"))}if("dashboard"!==page)return!1;$(".tablesorter").tablesorter();$(".tracker-table").find("> tbody > tr > td:nth-of-type(1)").click(function(a){$(a.target).is("input")||
(a=$(this).find("> input[type=checkbox]"),$(a).prop("checked",!a.prop("checked")))});$(".update-read").click(function(){var a=this,e=$(this).closest("tr"),b=$(e).attr("data-id"),p=$(e).find(".current"),c=$(e).find(".latest");$.post(base_url+"ajax/update_inline",{id:b,chapter:c.attr("data-chapter")},function(){$(a).hide();$(p).attr("href",$(c).attr("href")).text($(c).text())}).fail(function(a,e,b){switch(a.status){case 400:alert("ERROR: "+b);break;case 429:alert("ERROR: Rate limit reached.");break;
default:alert("ERROR: Something went wrong!\n"+b)}})});$("#delete_selected").click(function(a){a.preventDefault();a=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");0<a.length&&(a=$(a).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/delete_inline",{"id[]":a},function(){location.reload()}).fail(function(a,b,c){switch(a.status){case 400:alert("ERROR: "+c);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+
c)}}))});$("#file_import").change(function(){var a=this.files;if(a&&a[0])if(a=a[0],a.name.match(/\.json$/))if(2097152<a.size)c("ERROR: File too large ( < 2MB)!");else{var b=new FileReader;b.onload=function(a){a=a.target.result;var b;a:{try{JSON.parse(a)}catch(e){b=!1;break a}b=!0}b?(b=new FormData,b.append("json",a),$.ajax({type:"POST",url:"./import_list",data:b,success:function(){c("Upload was a success! Reloading page.",!0);setTimeout(function(){location.reload()},2500)},error:function(a,b,e){switch(a.status){case 400:alert("ERROR: "+
e);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+e)}},contentType:!1,processData:!1})):c("ERROR: File isn't valid JSON!")};b.readAsText(a)}else c("ERROR: Only .json is supported!")});$(".more-info").click(function(a){a.preventDefault();$(this).find("+ .tags").toggle();"More info"==$(this).text()?$(this).text("Hide info"):$(this).text("More info")});$(".edit-tags").click(function(a){a.preventDefault();$(this).parent().find(".tag-edit").toggleClass("hidden")});
$(".tag-edit input").on("keypress",function(){13===event.which&&$(this).closest(".tag-edit").find("[type=button]").click()});$(".tag-edit [type=button]").click(function(){var a=this,b=$(this).closest(".tag-edit").find("input").val().trim().replace(/,,/g,","),c=$(this).closest("tr").attr("data-id");if(/^[a-z0-9\-_,:]{0,255}$/.test(b)){var d=b.split(",");-1===$.inArray("none",d)?$.post(base_url+"ajax/tag_update",{id:c,tag_string:d.join(",")},function(){$(a).closest(".tags").find(".tag-list").text(d.join(",")||
"none");$(a).closest(".tag-edit").toggleClass("hidden")}).fail(function(a,b,c){switch(a.status){case 400:alert("ERROR: "+c);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+c)}}):alert('"none" is a restricted tag.')}else alert("Tags can only contain: lowercase a-z, 0-9, -, :, & _.")});$("#category-nav > .nav > li > a").click(function(a){a.preventDefault();$(this).closest("ul").find("> .active").removeClass("active");$(this).parent().addClass("active");
$(".tracker-table:visible").hide();$('.tracker-table[data-list="'+$(this).attr("data-list")+'"]').show()});$("#move-input").change(function(){var a=$(this).find(":selected");if(a.is("[value]")){var b=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");0<b.length&&(b=$(b).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/set_category",{"id[]":b,category:a.attr("value")},function(){location.reload()}).fail(function(a,b,c){switch(a.status){case 400:alert("ERROR: "+
c);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+c)}}))}});if("undefined"!==typeof use_live_countdown_timer&&use_live_countdown_timer)var b=$("#update-timer"),d=b.text().split(":"),g=parseInt(3600*d[0],10)+parseInt(60*d[1],10)+parseInt(d[2],10),h=setInterval(function(){var a=parseInt(g/60/60,10).toString(),c=parseInt(g/60%60,10).toString(),d=parseInt(g%60,10).toString();1==a.length&&(a="0"+a);1==c.length&&(c="0"+c);1==d.length&&(d="0"+d);b.text(a+
":"+c+":"+d);0>--g&&(clearInterval(h),setTimeout(function(){$("link[rel*='icon']").attr("href",base_url+"favicon.production.updated.ico")},6E4))},1E3);var l=$(window),n=$("#category-nav").offset().top-$("#category-nav > ul").height()-21,k=$("#list-nav"),m=$("table[data-list]");l.scroll(function(){f()});f()});$(function(){if("index"!==page)return!1;$(".example-image").hover(function(){$(this).attr("src",function(c,f){return f.replace(/.png$/,".gif")})},function(){$(this).attr("src",function(c,f){return f.replace(/.gif$/,".png")})})});$(function(){if("login"!==page)return!1;$(".button-checkbox").each(function(){function c(){var c=d.is(":checked");b.data("state",c?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+h[b.data("state")].icon);c?b.removeClass("btn-default").addClass("btn-"+g+" active"):b.removeClass("btn-"+g+" active").addClass("btn-default")}var f=$(this),b=f.find("button"),d=f.find("input:checkbox"),g=b.data("color"),h={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};
b.on("click",function(){d.prop("checked",!d.is(":checked"));d.triggerHandler("change");c()});d.on("change",function(){c()});c();0===b.find(".state-icon").length&&b.prepend('<i class="state-icon '+h[b.data("state")].icon+'"></i>\u00a0')})});$(function(){if("options"!==page)return!1;$("input[type=checkbox][name^=category_custom]").change(function(c){"1"==$(this).data("has-series")&&(alert("Unable to disable category while it still contains series."),$(this).prop("checked",!$(this).prop("checked")))});$("input[type=text][name^=category_custom]").click(function(){$(this).parent().find("[type=checkbox]").attr("checked",!0)})});$(function(){if("signup"!==page)return!1;$("#page[data-page=signup]").find("form").validate({ignore:[],onkeyup:!1,rules:{username:{minlength:4,maxlength:15,pattern:/^[a-zA-Z0-9_-]{4,15}$/,remote:{url:base_url+"ajax/username_check",type:"post",data:{username:function(){return $("input[name='username']").val()}}}}},messages:{username:{minlength:"This username is too short (Minimum 4 characters).",maxlength:"This username is too long (Maximum 15 characters).",pattern:"This username has invalid characters (Only allowed a-z, A-Z, 0-9, _ & - characters).",
remote:"This username already taken."}}});$(".button-checkbox").each(function(){function c(){var c=d.is(":checked");b.data("state",c?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+h[b.data("state")].icon);c?b.removeClass("btn-default").addClass("btn-"+g+" active"):b.removeClass("btn-"+g+" active").addClass("btn-default")}var f=$(this),b=f.find("button"),d=f.find("input:checkbox"),g=b.data("color"),h={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};
b.on("click",function(){d.prop("checked",!d.is(":checked"));d.triggerHandler("change");c()});d.on("change",function(){c()});c();0===b.find(".state-icon").length&&b.prepend('<i class="state-icon '+h[b.data("state")].icon+'"></i>')})});
