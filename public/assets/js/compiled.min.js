$(function(){$('[data-toggle="tooltip"]').tooltip({html:!0})});$(function(){function c(a,b){b="undefined"!==typeof b?b:!1;$("#import-status").text(a).show().delay(4E3).fadeOut(1E3).attr("style",b?"color: rgb(0, 230 ,0)":"color: rgb(230, 0 ,0)")}$(".tablesorter").tablesorter({sortList:[[0,0],[1,0]]});$(".update-read").click(function(a){var b=this;a=$(this).closest("tr");var d=$(a).attr("data-id"),f=$(a).find(".current"),e=$(a).find(".latest");$.post(base_url+"ajax/update_tracker_inline",{id:d,chapter:e.text()},function(a){$(b).hide();$(f).attr("href",$(e).attr("href")).text($(e).text())})});
$(".tracker-table").find("> tbody > tr > td:nth-of-type(1)").click(function(a){$(a.target).is("input")||(a=$(this).find("> input[type=checkbox]"),$(a).prop("checked",!a.prop("checked")))});$("#delete_selected").click(function(a){a.preventDefault();a=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");if(0<a.length){var b=[];$(a).each(function(){b.push($(this).attr("data-id"))});a=new FormData;a.append("json",JSON.stringify(b));$.ajax({type:"POST",url:"./ajax/delete_inline",
data:a,success:function(){location.reload()},error:function(a,b,e){},contentType:!1,processData:!1})}});$("#file_import").change(function(){var a=this.files;if(a&&a[0])if(a=a[0],a.name.match(/\.json$/))if(2097152<a.size)c("ERROR: File too large ( < 2MB)!");else{var b=new FileReader;b.onload=function(a){a=a.target.result;var b;a:{try{JSON.parse(a)}catch(e){b=!1;break a}b=!0}b?(b=new FormData,b.append("json",a),$.ajax({type:"POST",url:"./import_list",data:b,success:function(){c("Upload was a success! Reloading page.",
!0);setTimeout(function(){location.reload()},2500)},error:function(a,b,d){c("ERROR: Upload failed! - "+a.status)},contentType:!1,processData:!1})):c("ERROR: File isn't valid JSON!")};b.readAsText(a)}else c("ERROR: Only .json is supported!")});$(".more-info").click(function(a){a.preventDefault();$(this).find("+ .tags").toggle();"More info"==$(this).text()?$(this).text("Hide info"):$(this).text("More info")});$(".edit-tags").click(function(a){a.preventDefault();$(this).parent().find(".tag-edit").toggleClass("hidden")});
$(".tag-edit input").on("keypress",function(){13===event.which&&$(this).closest(".tag-edit").find("[type=button]").click()});$(".tag-edit [type=button]").click(function(){var a=this,b=$(this).closest(".tag-edit").find("input").val().trim().replace(/,,/g,","),d=$(this).closest("tr").attr("data-id");if(/^[a-z0-9,\-_]{0,255}$/.test(b)){var c=b.split(",");-1===$.inArray("none",c)?(b=new FormData,b.append("id",d),b.append("tag_string",c.join(",")),$.ajax({type:"POST",url:"./ajax/tag/update",data:b,success:function(){$(a).closest(".tags").find(".tag-list").text(c.join(",")||
"none");$(a).closest(".tag-edit").toggleClass("hidden")},error:function(a,b,c){},contentType:!1,processData:!1})):alert('"none" is a restricted tag.')}else alert("Tags can only contain: lowercase a-z, 0-9, - & _.")});$("#category-nav > .nav > li > a").click(function(a){a.preventDefault();$(this).closest("ul").find("> .active").removeClass("active");$(this).parent().addClass("active");$(".tracker-table:visible").hide();$('.tracker-table[data-list="'+$(this).attr("data-list")+'"]').show()});$("#move-input").change(function(){var a=
$(this).find(":selected");if(a.is("[value]")){var b=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");if(0<b.length){var c={id_list:[],category:a.attr("value")};$(b).each(function(){c.id_list.push($(this).attr("data-id"))});a=new FormData;a.append("json",JSON.stringify(c));$.ajax({type:"POST",url:"./ajax/set_category",data:a,success:function(){location.reload()},error:function(a,b,c){},contentType:!1,processData:!1})}}})});$(function(){$(".button-checkbox").each(function(){function c(){var a=d.is(":checked");b.data("state",a?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+e[b.data("state")].icon);a?b.removeClass("btn-default").addClass("btn-"+f+" active"):b.removeClass("btn-"+f+" active").addClass("btn-default")}var a=$(this),b=a.find("button"),d=a.find("input:checkbox"),f=b.data("color"),e={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};b.on("click",function(){d.prop("checked",
!d.is(":checked"));d.triggerHandler("change");c()});d.on("change",function(){c()});c();0==b.find(".state-icon").length&&b.prepend('<i class="state-icon '+e[b.data("state")].icon+'"></i>\u00a0')})});$(function(){$("input[type=checkbox][name^=category_custom]").change(function(c){"1"==$(this).data("has-series")&&(alert("Unable to disable category while it still contains series."),$(this).prop("checked",!$(this).prop("checked")))});$("input[type=text][name^=category_custom]").click(function(){$(this).parent().find("[type=checkbox]").attr("checked",!0)})});$(function(){$("#page[data-page=signup] form").validate({ignore:[],onkeyup:!1,rules:{username:{minlength:4,maxlength:15,pattern:/^[a-zA-Z0-9_-]{4,15}$/,remote:{url:base_url+"ajax/username_check",type:"post",data:{username:function(){return $("input[name='username']").val()}}}}},messages:{username:{minlength:"This username is too short (Minimum 4 characters).",maxlength:"This username is too long (Maximum 15 characters).",pattern:"This username has invalid characters (Only allowed a-z, A-Z, 0-9, _ & - characters).",
remote:"This username already taken."}}})});
