$(function(){$('[data-toggle="tooltip"]').tooltip({html:!0})});$(function(){function e(a,c){c="undefined"!==typeof c?c:!1;$("#import-status").text(a).show().delay(4E3).fadeOut(1E3).attr("style",c?"color: rgb(0, 230 ,0)":"color: rgb(230, 0 ,0)")}$(".tablesorter").tablesorter();$(".tracker-table").find("> tbody > tr > td:nth-of-type(1)").click(function(a){$(a.target).is("input")||(a=$(this).find("> input[type=checkbox]"),$(a).prop("checked",!a.prop("checked")))});$(".update-read").click(function(){var a=this,c=$(this).closest("tr"),k=$(c).attr("data-id"),g=$(c).find(".current"),
b=$(c).find(".latest");$.post(base_url+"ajax/update_inline",{id:k,chapter:b.attr("data-chapter")},function(){$(a).hide();$(g).attr("href",$(b).attr("href")).text($(b).text())}).fail(function(a,c,b){switch(a.status){case 400:alert("ERROR: "+b);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+b)}})});$("#delete_selected").click(function(a){a.preventDefault();a=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");0<a.length&&
(a=$(a).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/delete_inline",{"id[]":a},function(){location.reload()}).fail(function(a,b,g){switch(a.status){case 400:alert("ERROR: "+g);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+g)}}))});$("#file_import").change(function(){var a=this.files;if(a&&a[0])if(a=a[0],a.name.match(/\.json$/))if(2097152<a.size)e("ERROR: File too large ( < 2MB)!");else{var c=new FileReader;
c.onload=function(a){a=a.target.result;var c;a:{try{JSON.parse(a)}catch(b){c=!1;break a}c=!0}c?(c=new FormData,c.append("json",a),$.ajax({type:"POST",url:"./import_list",data:c,success:function(){e("Upload was a success! Reloading page.",!0);setTimeout(function(){location.reload()},2500)},error:function(a,c,b){switch(a.status){case 400:alert("ERROR: "+b);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+b)}},contentType:!1,processData:!1})):e("ERROR: File isn't valid JSON!")};
c.readAsText(a)}else e("ERROR: Only .json is supported!")});$(".more-info").click(function(a){a.preventDefault();$(this).find("+ .tags").toggle();"More info"==$(this).text()?$(this).text("Hide info"):$(this).text("More info")});$(".edit-tags").click(function(a){a.preventDefault();$(this).parent().find(".tag-edit").toggleClass("hidden")});$(".tag-edit input").on("keypress",function(){13===event.which&&$(this).closest(".tag-edit").find("[type=button]").click()});$(".tag-edit [type=button]").click(function(){var a=
this,c=$(this).closest(".tag-edit").find("input").val().trim().replace(/,,/g,","),b=$(this).closest("tr").attr("data-id");if(/^[a-z0-9,\-_]{0,255}$/.test(c)){var d=c.split(",");-1===$.inArray("none",d)?$.post(base_url+"ajax/tag_update",{id:b,tag_string:d.join(",")},function(){$(a).closest(".tags").find(".tag-list").text(d.join(",")||"none");$(a).closest(".tag-edit").toggleClass("hidden")}).fail(function(a,c,b){switch(a.status){case 400:alert("ERROR: "+b);break;case 429:alert("ERROR: Rate limit reached.");
break;default:alert("ERROR: Something went wrong!\n"+b)}}):alert('"none" is a restricted tag.')}else alert("Tags can only contain: lowercase a-z, 0-9, - & _.")});$("#category-nav > .nav > li > a").click(function(a){a.preventDefault();$(this).closest("ul").find("> .active").removeClass("active");$(this).parent().addClass("active");$(".tracker-table:visible").hide();$('.tracker-table[data-list="'+$(this).attr("data-list")+'"]').show()});$("#move-input").change(function(){var a=$(this).find(":selected");
if(a.is("[value]")){var c=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)");0<c.length&&(c=$(c).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/set_category",{"id[]":c,category:a.attr("value")},function(){location.reload()}).fail(function(a,c,b){switch(a.status){case 400:alert("ERROR: "+b);break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+b)}}))}});if("undefined"!==typeof use_live_countdown_timer&&
use_live_countdown_timer)var f=$("#update-timer"),b=f.text().split(":"),d=parseInt(3600*b[0],10)+parseInt(60*b[1],10)+parseInt(b[2],10),h=setInterval(function(){var a=parseInt(d/60/60,10).toString(),c=parseInt(d/60%60,10).toString(),b=parseInt(d%60,10).toString();1==a.length&&(a="0"+a);1==c.length&&(c="0"+c);1==b.length&&(b="0"+b);f.text(a+":"+c+":"+b);0>--d&&clearInterval(h)},1E3)});$(function(){$(".button-checkbox").each(function(){function e(){var c=d.is(":checked");b.data("state",c?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+a[b.data("state")].icon);c?b.removeClass("btn-default").addClass("btn-"+h+" active"):b.removeClass("btn-"+h+" active").addClass("btn-default")}var f=$(this),b=f.find("button"),d=f.find("input:checkbox"),h=b.data("color"),a={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};b.on("click",function(){d.prop("checked",
!d.is(":checked"));d.triggerHandler("change");e()});d.on("change",function(){e()});e();0==b.find(".state-icon").length&&b.prepend('<i class="state-icon '+a[b.data("state")].icon+'"></i>\u00a0')})});$(function(){$("input[type=checkbox][name^=category_custom]").change(function(e){"1"==$(this).data("has-series")&&(alert("Unable to disable category while it still contains series."),$(this).prop("checked",!$(this).prop("checked")))});$("input[type=text][name^=category_custom]").click(function(){$(this).parent().find("[type=checkbox]").attr("checked",!0)})});$(function(){$("#page[data-page=signup] form").validate({ignore:[],onkeyup:!1,rules:{username:{minlength:4,maxlength:15,pattern:/^[a-zA-Z0-9_-]{4,15}$/,remote:{url:base_url+"ajax/username_check",type:"post",data:{username:function(){return $("input[name='username']").val()}}}}},messages:{username:{minlength:"This username is too short (Minimum 4 characters).",maxlength:"This username is too long (Maximum 15 characters).",pattern:"This username has invalid characters (Only allowed a-z, A-Z, 0-9, _ & - characters).",
remote:"This username already taken."}}})});
