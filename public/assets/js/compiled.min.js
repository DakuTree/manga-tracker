var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var c=a.length,h=0;h<c;h++){var e=a[h];if(d.call(b,e,h,a))return{i:h,v:e}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,d,b,c){if(d){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var h=a[c];h in b||(b[h]={});b=b[h]}a=a[a.length-1];c=b[a];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,c={next:function(){if(b<a.length){var h=b++;return{value:d(h,a[h]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");$jscomp.polyfill("Array.from",function(a){return a?a:function(a,b,c){$jscomp.initSymbolIterator();b=null!=b?b:function(a){return a};var d=[],e=a[Symbol.iterator];if("function"==typeof e)for(a=e.call(a);!(e=a.next()).done;)d.push(b.call(c,e.value));else for(var e=a.length,k=0;k<e;k++)d.push(b.call(c,a[k]));return d}},"es6-impl","es3");
$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var d=a[Symbol.iterator];return d?d.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,d){return Object.prototype.hasOwnProperty.call(a,d)};
$jscomp.polyfill("WeakMap",function(a){function d(a){$jscomp.owns(a,c)||$jscomp.defineProperty(a,c,{value:{}})}function b(a){var b=Object[a];b&&(Object[a]=function(a){d(a);return b(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d["delete"](b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(f){return!1}}())return a;var c="$jscomp_hidden_"+Math.random().toString().substring(2);b("freeze");b("preventExtensions");
b("seal");var h=0,e=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,c))throw Error("WeakMap key fail: "+a);a[c][this.id_]=b;return this};e.prototype.get=function(a){return $jscomp.owns(a,c)?a[c][this.id_]:void 0};e.prototype.has=function(a){return $jscomp.owns(a,c)&&$jscomp.owns(a[c],this.id_)};e.prototype["delete"]=
function(a){return $jscomp.owns(a,c)&&$jscomp.owns(a[c],this.id_)?delete a[c][this.id_]:!1};return e},"es6-impl","es3");$jscomp.MapEntry=function(){};$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||"s"!=g.value[1])return!1;g=f.next();return g.done||4!=g.value[0].x||"t"!=g.value[1]||!f.next().done?!1:!0}catch(u){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var d=new WeakMap,b=function(a){this.data_={};this.head_=e();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};b.prototype.set=function(a,b){var f=c(this,a);f.list||(f.list=this.data_[f.id]=[]);f.entry?f.entry.value=b:(f.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},f.list.push(f.entry),this.head_.previous.next=f.entry,this.head_.previous=f.entry,this.size++);return this};b.prototype["delete"]=
function(a){a=c(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};b.prototype.has=function(a){return!!c(this,a).entry};b.prototype.get=function(a){return(a=c(this,a).entry)&&a.value};b.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};b.prototype.keys=function(){return h(this,function(a){return a.key})};b.prototype.values=function(){return h(this,function(a){return a.value})};b.prototype.forEach=function(a,b){for(var f=this.entries(),g;!(g=f.next()).done;)g=g.value,a.call(b,g[1],g[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var c=function(a,b){var f=b&&typeof b;"object"==f||"function"==f?d.has(b)?f=d.get(b):(f=""+ ++k,d.set(b,f)):f="p_"+b;var g=a.data_[f];if(g&&$jscomp.owns(a.data_,f))for(var c=0;c<g.length;c++){var p=
g[c];if(b!==b&&p.key!==p.key||b===p.key)return{id:f,list:g,index:c,entry:p}}return{id:f,list:g,index:-1,entry:void 0}},h=function(a,b){var f=a.head_;return $jscomp.iteratorPrototype(function(){if(f){for(;f.head!=a.head_;)f=f.previous;for(;f.next!=f.head;)return f=f.next,{done:!1,value:b(f)};f=null}return{done:!0,value:void 0}})},e=function(){var a={};return a.previous=a.next=a.head=a},k=0;return b},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(a){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||e.value[1]!=b)return!1;e=d.next();return e.done||e.value[0]==b||4!=e.value[0].x||e.value[1]!=e.value[0]?!1:d.next().done}catch(k){return!1}}())return a;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};d.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};d.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};d.prototype.clear=function(){this.map_.clear();this.size=0};d.prototype.has=function(a){return this.map_.has(a)};d.prototype.entries=
function(){return this.map_.entries()};d.prototype.values=function(){return this.map_.values()};d.prototype.keys=d.prototype.values;d.prototype[Symbol.iterator]=d.prototype.values;d.prototype.forEach=function(a,c){var b=this;this.map_.forEach(function(d){return a.call(c,d,d,b)})};return d},"es6-impl","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,b){var c=this;c instanceof String&&(c=String(c));for(var d=c.length,e=b||0;e<d;e++)if(c[e]==a||Object.is(c[e],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,d,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6-impl","es3");
$(function(){$('[data-toggle="tooltip"]').tooltip({html:!0});$.tablesorter.defaults.headerTemplate="{content} {icon}";$(".tablesorter").tablesorter({});$(".clear-text-input").click(function(a){a.preventDefault();$(this).prev("input").val("").trigger("input")})});$(function(){function a(a,b){var f=[],g="asc"===b?"a":"d";switch(a){case "unread":f=[[0,"a"],[1,g]];break;case "unread_latest":f=[[0,"a"],[3,g]];break;case "alphabetical":f=[[1,g]];break;case "my_status":f=[[2,g]];break;case "latest":f=[[3,g]]}return f}function d(a,b){$.isArray(a)||(a=a.trim().replace(/,,/g,","));if(/^[a-z0-9\-_,:]{0,255}$/.test(a)){var f=Array.from(new Set(a.split(","))).filter(function(a){return""!==a}),g=f.join(",");-1===$.inArray("none",f)?1>=(a.match(/\bmal:(?:[0-9]+|none)\b/g)||
[]).length?b(g):alert("You can only use one MAL ID tag per series"):alert('"none" is a restricted tag.')}else alert("Tags can only contain: lowercase a-z, 0-9, -, :, & _. They can also only have one MAL metatag.")}function b(a,b){var f=a.find("tr .update-read:not([style])").length,g=b.find("> td:eq(0)"),d=b.find("> td:eq(2)");b.find(".update-read, .ignore-latest").hide();d.attr("data-updated-at",(new Date).toISOString().replace(/^([0-9]+-[0-9]+-[0-9]+)T([0-9]+:[0-9]+:[0-9]+)\.[0-9]+Z$/,"$1 $2"));
a.trigger("updateCell",[d[0],!1,null]);g.find(" > span").text("1");a.trigger("updateCell",[g[0],!1,null]);g=0<f?" ("+f+" unread)":"";a.find("thead > tr > th:eq(1) > div").text("Series"+g);a.attr("data-unread",f);"reading"===a.attr("data-list")&&c()}function c(){var a=$("table[data-list=reading]").attr("data-unread"),a=99<parseInt(a)?"99+":a,b=$('link[rel="shortcut icon"]');if(0!==parseInt(a)){var c=$("<canvas/>",{id:"faviconCanvas",style:"/*display: none*/"})[0];c.width=32;c.height=32;var d=c.getContext("2d"),
e=new Image;e.onload=function(){d.drawImage(e,0,0,32,32);d.font="Bold 17px Helvetica";d.textAlign="right";d.lineWidth=3;d.strokeStyle="white";d.strokeText(a,32,30);d.fillStyle="black";d.fillText(a,32,30);b.attr("href",c.toDataURL())};e.src=base_url+"favicon.ico"}else b.attr("href",base_url+"favicon.ico")}function h(a,b,c){switch(a.status){case 400:alert("ERROR: "+c);break;case 401:alert("Session has expired, please re-log to continue.");break;case 429:alert("ERROR: Rate limit reached.");break;default:alert("ERROR: Something went wrong!\n"+
c)}}if("dashboard"!==page)return!1;$.tablesorter.addParser({id:"updated-at",is:function(){return!1},format:function(a,b,c,d){return parseInt($(c).attr("data-updated-at").replace(/[^0-9]+/g,""))},type:"numeric"});$.tablesorter.addParser({id:"latest",is:function(){return!1},format:function(a,b,c,d){return parseInt($(c).closest("tr").find("td:eq(1) .sprite-time").attr("title").replace(/[^0-9]+/g,""))},type:"numeric"});$.tablesorter.filter.types.FindMalId=function(a,b){if(/^mal:(?:[0-9]+|any|none|notset)$/.test(b.iFilter)){var f=
b.iFilter.match(/^mal:([0-9]+|any|none|notset)$/)[1].toLowerCase();switch(f){case "any":f=0<b.$row.find("> td:eq(1) i.sprite-myanimelist-net").length;break;case "none":f=0<b.$row.find("> td:eq(1) i.sprite-myanimelist-net-none").length;break;case "notset":f=0===b.$row.find('> td:eq(1) i[class*="sprite-myanimelist-net"]').length;break;default:var c=b.$row.find("> td:eq(1) i.sprite-myanimelist-net").attr("title"),f=f===c}return f}return null};$.tablesorter.filter.types.FindSite=function(a,b){if(/^site:[\w-.]+$/.test(b.iFilter)){var f=
b.iFilter.match(/^site:([\w-.]+)$/i)[1].replace(/\./g,"-").toLowerCase(),c=b.$row.find("> td:eq(1) .sprite-site").attr("class").split(" ")[1].substr(7);return f===c}return null};$.tablesorter.filter.types.FindTag=function(a,b){if(/^tag:[a-z0-9\-_:,]{1,255}$/.test(b.iFilter)){var f=b.iFilter.match(/^tag:([a-z0-9\-_:,]{1,255})$/)[1].split(","),c=b.$row.find("td:eq(1) .tag-list .tag").map(function(a,b){return $(b).text()}).toArray();return f.every(function(a){return-1!==$.inArray(a,c)})}return null};
$.tablesorter.filter.types.FindChecked=function(a,b){if(/^checked:(?:yes|no)$/.test(b.iFilter)){var f=b.iFilter.match(/^checked:(yes|no)$/)[1].toLowerCase(),c=b.$row.find("> td:eq(0) input").is(":checked");"no"===f&&(c=!c);return c}return null};$(".tracker-table").tablesorter({initialized:function(a){a.config.sortVars.forEach(function(a){a.count=-1});$(a.config.headerList[4]).find(".fa-spin").remove()},sortList:a(list_sort_type,list_sort_order),headers:{1:{sortInitialOrder:"asc"},2:{sortInitialOrder:"desc",
sorter:"updated-at"},3:{sortInitialOrder:"desc",sorter:"latest"}},widgets:["zebra","filter"],widgetOptions:{filter_external:"#search",filter_columnFilters:!1,filter_saveFilters:!1,filter_reset:".reset"}});$(".tracker-table").find("> tbody > tr > td:nth-of-type(1)").click(function(a){$(a.target).is("input")||(a=$(this).find("> input[type=checkbox]"),$(a).prop("checked",!a.prop("checked")))});$("input[name=check]").change(function(){null===window.onbeforeunload?window.onbeforeunload=function(a){if(a=
a||window.event)a.returnValue="You appear to have some checked titles.\nDo you still wish to continue?";return"You appear to have some checked titles.\nDo you still wish to continue?"}:0===$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)").length&&(window.onbeforeunload=null)});$(".toggle-info").click(function(a){a.preventDefault();$(this).find("+ .more-info").toggle();"More info"===$(this).text()?$(this).text("Hide info"):($(this).text("More info"),$(this).closest("tr").find(".tag-edit").addClass("hidden"))});
/^\/list\//.test(location.pathname)||c();$("#update-notice").on("closed.bs.alert",function(){$.post(base_url+"ajax/hide_notice")});$("#category-nav").find("> .nav > li > a").click(function(a){a.preventDefault();$(this).closest("ul").find("> .active").removeClass("active");$(this).parent().addClass("active");$(".tracker-table:visible").hide();a=$(this).attr("data-list");a=$('.tracker-table[data-list="'+a+'"]');a.show();a.has(".odd, .even").length||a.trigger("update",[!0]);$("html, body").animate({scrollTop:0},
"slow")});(function(){function a(){b.scrollTop()>=d?(e.css("margin-top","97px"),c.addClass("fixed-header"),c.css("width",$("#list-nav").parent().width()+"px")):(e.css("margin-top","5px"),c.removeClass("fixed-header"),c.css("width","initial"))}var b=$(window),c=$("#list-nav"),d=c.offset().top-c.find("> ul").height()-21,e=$("table[data-list]");b.scroll(function(){a()});a()})();(function(){$("#toggle-nav-options").click(function(a){a.preventDefault();a=$(this).find("> i");var b=$("#nav-options");a.toggleClass("down");
a.hasClass("down")?b.hide().slideDown(500):b.show().slideUp(500)});$(".list_sort").change(function(){var b=$(".tracker-table"),c=$("select[name=list_sort_type]").val(),d=$("select[name=list_sort_order]"),e=d.val();if("n/a"!==c){if("list_sort_type"===$(this).attr("name")){switch(c){case "unread_latest":e="desc";break;case "my_status":e="desc";break;case "latest":e="desc";break;default:e="asc"}d.val(e)}b.trigger("sorton",[a(c,e)])}});$(".tracker-table").bind("sortEnd",function(){var a=$("select[name=list_sort_type]"),
b=$("select[name=list_sort_order]"),c=this.config.sortList.reduce(function(a,b,c){a[b[0]]=b[1];return a},{}),d="n/a",e="asc";switch(Object.keys(c).join()){case "0,1":0===c[0]&&(d="unread",e=0===c[1]?"asc":"desc");break;case "0,3":0===c[0]&&(d="unread-latest",e=0===c[1]?"asc":"desc");break;case "1":d="alphabetical";e=0===c[1]?"asc":"desc";break;case "2":d="my_status";e=0===c[2]?"asc":"desc";break;case "3":d="latest",e=0===c[3]?"asc":"desc"}a.val(d);b.val(e)})})();if("undefined"!==typeof use_live_countdown_timer&&
use_live_countdown_timer&&!/^\/list\//.test(location.pathname))var e=$("#update-timer"),k=e.text().split(":"),l=parseInt(3600*k[0],10)+parseInt(60*k[1],10)+parseInt(k[2],10),m=setInterval(function(){var a=parseInt(l/60/60,10).toString(),b=parseInt(l/60%60,10).toString(),c=parseInt(l%60,10).toString();1===a.length&&(a="0"+a);1===b.length&&(b="0"+b);1===c.length&&(c="0"+c);e.text(a+":"+b+":"+c);0>--l&&(clearInterval(m),setTimeout(function(){$('link[rel*="icon"]').attr("href",base_url+"favicon.production.updated.ico")},
6E4))},1E3);$(".update-read").click(function(a,c){var d=$(this).closest("tr"),f=$(this).closest("table"),e=$(d).attr("data-id"),g=$(d).find(".current"),r=$(d).find(".latest");c&&c.isUserscript?(console.log("Userscript is updating table..."),c.isLatest?b(f,d):(e=g.parent(),e.attr("data-updated-at",(new Date).toISOString().replace(/^([0-9]+-[0-9]+-[0-9]+)T([0-9]+:[0-9]+:[0-9]+)\.[0-9]+Z$/,"$1 $2")),f.trigger("updateCell",[e[0],!1,null]))):(e={id:e,chapter:r.attr("data-chapter")},$.post(base_url+"ajax/update_inline",
e,function(){$(g).attr("href",$(r).attr("href")).text($(r).text());b(f,d)}).fail(function(a,b,c){h(a,b,c)}))});$(".ignore-latest").click(function(){var a=$(this).closest("tr"),c=$(this).closest("table"),d=$(a).attr("data-id"),e=$(a).find(".current"),k=$(a).find(".latest");confirm("Ignore latest chapter?")&&(d={id:d,chapter:k.attr("data-chapter")},$.post(base_url+"ajax/ignore_inline",d,function(){$(e).parent().append($("<span/>",{"class":"hidden-chapter",title:"This latest chapter was marked as ignored.",
text:$(k).text()}));b(c,a)}).fail(function(a,b,c){h(a,b,c)}))});$("#mass-action").find("> select").change(function(){var a=!1,b=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)"),c=b.length;if(0<c){var e={"id[]":$(b).map(function(){return parseInt($(this).attr("data-id"))}).toArray()};switch($(this).val()){case "delete":confirm("Are you sure you want to delete the "+c+" selected row(s)?")&&$.post(base_url+"ajax/delete_inline",e,function(){a=!0;location.reload()}).fail(function(a,
b,c){h(a,b,c)});break;case "tag":confirm("Are you sure you want to edit the tags of "+c+" selected row(s)?")&&(b=prompt("Tags: "),d(b,function(b){e.tag_string=b;$.post(base_url+"ajax/mass_tag_update",e,function(){a=!0;location.reload()}).fail(function(a,b,c){h(a,b,c)})}))}}else alert("No selected series found.");"n/a"===$(this).val()||a||(console.log("resetting value"),$(this).val("n/a"))});$(".set-mal-id").click(function(a){function b(a,b,c){c="0"!==c?c:"none";b.length?b.find("small").text(c):$("<span/>").append($("<small/>",
{text:c})).prepend(" (").append(")").insertAfter(a)}function c(a,b,c){c=c||function(){};$.post(base_url+"ajax/set_mal_id",{id:a,mal_id:b},function(){c()}).fail(function(a,b,c){h(a,b,c)})}var d=this;a.preventDefault();var f=this;a=$(this).attr("data-mal-id");if("title"!==$(this).attr("data-mal-type")||!$(this).attr("data-mal-id")||confirm("A MAL ID already exists for this series on our backend.\n Are you sure you want to override it?")){var e=prompt("MAL ID:",a);if(/^([0-9]+|none)?$/.test(e)){/^[0-9]+$/.test(e)&&
(e=parseInt(e));a=$(this).closest("tr");var k=a.find("td:eq(1)"),l=$(this).closest("table");a=a.attr("data-id");var n=$(k).find(".sprite-myanimelist-net").parent(),t=$(k).find(".sprite-myanimelist-net-none").parent(),m=$(this).find("+ span"),q=$.Deferred();""!==e&&"none"!==e&&0!==e?c(a,e,function(){$(t).remove();n.length?($(n).attr("href","https://myanimelist.net/manga/"+e),$(n).find(".sprite-myanimelist-net").attr("title",e)):$($("<a/>",{href:"https://myanimelist.net/manga/"+e,"class":"mal-link"}).append($("<i/>",
{"class":"sprite-site sprite-myanimelist-net",title:e}))).prepend(" ").insertAfter(k.find(".sprite-site"));b($(f),m,e);q.resolve()}):"none"===e||0===e?c(a,"0",function(){n.remove();t.remove();$($("<a/>",{"class":"mal-link"}).append($("<i/>",{"class":"sprite-site sprite-myanimelist-net-none",title:e}))).prepend(" ").insertAfter(k.find(".sprite-site"));b($(f),m,"none");q.resolve()}):c(a,null,function(){n.remove();t.remove();m.remove();q.resolve()});q.done(function(){$(d).attr("data-mal-id",e);l.trigger("updateCell",
[k[0],!1,null])})}else null!==e&&alert("MAL ID can only contain numbers.")}});(function(){$(".edit-tags").click(function(a){a.preventDefault();var b=$(this).parent().find(".tag-edit");b.toggleClass("hidden");b.hasClass("hidden")||setTimeout(function(){var a=b.find("> input");a.focus();var c=a.val();a.val("");a.val(c)},1)});$(".tag-edit input").on("keypress",function(a){13===a.which&&$(this).closest(".tag-edit").find("[type=button]").click()});$(".tag-edit [type=button]").click(function(){var a=this,
b=$(this).closest(".tag-edit").find("input"),c=b.val().toString().trim().replace(/,,/g,","),e=$(this).closest("tr").attr("data-id"),k=$(this).closest("table"),l=$(this).closest("td");d(c,function(c){$.post(base_url+"ajax/tag_update",{id:e,tag_string:c},function(){$(b).val(c);var d=$(a).closest(".more-info").find(".tag-list");if(c){var e=c.split(",").map(function(a,b){return $("<i/>",{"class":"tag",text:a})});d.html(e)}else d.text("none");k.trigger("updateCell",[l[0],!1,null]);$(a).closest(".tag-edit").toggleClass("hidden")}).fail(function(a,
b,c){h(a,b,c)})})})})();$("#move-input").change(function(){var a=$(this).find(":selected"),b=a.text();if(a.is("[value]")){var c=$(".tracker-table:visible").find("tr:has(td input[type=checkbox]:checked)"),d=c.length;0<c.length&&confirm("Are you sure you want to move the "+d+" selected row(s) to the "+b+" category?")?(b=$(c).map(function(){return parseInt($(this).attr("data-id"))}).toArray(),$.post(base_url+"ajax/set_category",{"id[]":b,category:a.attr("value")},function(){location.reload()}).fail(function(a,
b,c){h(a,b,c)})):$("#move-input").val("---")}})});$(function(){if("history"!==page)return!1;$(".pagination").pagination({currentPage:currentPagination,pages:totalPagination,displayedPages:10,hrefTextPrefix:/user\/history/.test(location.pathname)?"/user/history/":"/history/"+titleID+"/",selectOnClick:!1,prevText:"&laquo;",nextText:"&raquo;"})});$(function(){if("import_amr"!==page)return!1;var a="Manga-Fox;Batoto;Manga Here;MangaStream;Manga Panda;Kirei Cake;Dynasty Scans;Manga Reader;Easy Going".split(";");$("#amr_import").change(function(){var d=this.files;if(d&&d[0])if(d=d[0],d.name.match(/\.(json|txt)$/))if(2097152<d.size)alert("ERROR: File too large ( < 2MB)!");else{var b=new FileReader;b.onload=function(b){b=b.target.result;a:{try{JSON.parse(b)}catch(g){var c=!1;break a}c=!0}if(c)if(b=JSON.parse(b),b.mangas){var d={};if(JSON.parse(b.mangas).every(function(a){return"mirror"in
a||"name"in a||"url"in a||"lastChapterReadURL"in a?(d[a.mirror]||(d[a.mirror]=[]),d[a.mirror].push(a),!0):!1}))for(var k in d){if(d.hasOwnProperty(k)){b=d[k];c=a.includes(k)?"#amr_good":"#amr_bad";"#amr_bad"===c&&$("#amr_bad").is(":empty")&&$("<h3/>",{text:"Incompatible Sites"}).appendTo("#amr_bad");$("<h4/>",{text:k+" ("+b.length+")"}).appendTo(c);var l=$("<tbody/>",{"aria-live":"polite","aria-relevant":"all"}),m;for(m in b)if(b.hasOwnProperty(m)){var f=b[m],f=$("<tr/>",{role:"row"}).append($("<td/>",
{style:"width: 50%"}).append($("<a/>",{href:f.url,text:f.name}))).append($("<td/>",{style:"width: 50%"}).append($("<a/>",{href:f.lastChapterReadURL,text:f.lastChapterReadName})));l.append(f)}$("<table/>",{"class":"tablesorter tablesorter-bootstrap table-striped",role:"grid"}).append($("<thead/>").append($("<tr/>").append($("<th/>",{text:"Title"})).append($("<th/>",{text:"Current Chapter"})))).append(l).appendTo(c)}}else alert("JSON has invalid keys?")}else alert('JSON file is missing "mangas" object. Was this exported from AMR?');
else alert("ERROR: File isn't valid JSON!")};b.readAsText(d)}else alert("ERROR: Only .json/txt is supported!")})});$(function(){if("index"!==page)return!1;$(".example-image").hover(function(){$(this).attr("src",function(a,d){return d.replace(/\.png$/,".gif")})},function(){$(this).attr("src",function(a,d){return d.replace(/\.gif$/,".png")})})});$(function(){if("login"!==page)return!1;$(".button-checkbox").each(function(){function a(){var a=c.is(":checked");b.attr("data-state",a?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+e[b.attr("data-state")].icon);a?b.removeClass("btn-default").addClass("btn-"+h+" active"):b.removeClass("btn-"+h+" active").addClass("btn-default")}var d=$(this),b=d.find("button"),c=d.find("input:checkbox"),h=b.attr("data-color"),e={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};
b.on("click",function(){c.prop("checked",!c.is(":checked"));c.triggerHandler("change");a()});c.on("change",function(){a()});a();0===b.find(".state-icon").length&&b.prepend('<i class="state-icon '+e[b.attr("data-state")].icon+'"></i>\u00a0')})});$(function(){if("options"!==page)return!1;$("input[type=checkbox][name^=category_custom]").change(function(){"1"===$(this).attr("data-has-series")&&(alert("Unable to disable category while it still contains series."),$(this).prop("checked",!$(this).prop("checked")))});$("input[type=text][name^=category_custom]").click(function(){$(this).parent().find("[type=checkbox]").attr("checked",!0)})});$(function(){if("signup"!==page)return!1;$("#page[data-page=signup]").find("form").validate({ignore:[],onkeyup:!1,rules:{username:{minlength:4,maxlength:15,pattern:/^[a-zA-Z0-9_-]{4,15}$/,remote:{url:base_url+"ajax/username_check",type:"post",data:{username:function(){return $('input[name="username"]').val()}}}}},messages:{username:{minlength:"This username is too short (Minimum 4 characters).",maxlength:"This username is too long (Maximum 15 characters).",pattern:"This username has invalid characters (Only allowed a-z, A-Z, 0-9, _ & - characters).",
remote:"This username already taken."}}});$(".button-checkbox").each(function(){function a(){var a=c.is(":checked");b.attr("data-state",a?"on":"off");b.find(".state-icon").removeClass().addClass("state-icon "+e[b.attr("data-state")].icon);a?b.removeClass("btn-default").addClass("btn-"+h+" active"):b.removeClass("btn-"+h+" active").addClass("btn-default")}var d=$(this),b=d.find("button"),c=d.find("input:checkbox"),h=b.attr("data-color"),e={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};
b.on("click",function(){c.prop("checked",!c.is(":checked"));c.triggerHandler("change");a()});c.on("change",function(){a()});a();0===b.find(".state-icon").length&&b.prepend('<i class="state-icon '+e[b.attr("data-state")].icon+'"></i>')})});
